{"timestamp":"2025-11-29 11:07:36","message":"N3IWF_CONTEXT","data":{"config":{"Info":{"Version":"1.0.5","Description":"N3IWF initial local configuration"},"Configuration":{"N3IWFInfo":{"GlobalN3IWFID":{"PLMNID":{"Mcc":"208","Mnc":"93"},"N3IWFID":135},"RanNodeName":"free5GC_N3IWF","SupportedTAList":[{"TAC":"000001","BroadcastPLMNList":[{"PLMNID":{"Mcc":"208","Mnc":"93"},"TAISliceSupportList":[{"SNSSAI":{"SST":1,"SD":"010203"}},{"SNSSAI":{"SST":1,"SD":"112233"}}]}]}]},"LocalSctpAddr":"","AMFSCTPAddresses":[{"IPAddresses":["amf.free5gc.org"],"Port":38412}],"Metrics":null,"TCPPort":20000,"IKEBindAddr":"192.168.10.254","UEIPAddressRange":"10.0.0.0/24","IPSecGatewayAddr":"10.0.0.1","XfrmIfaceName":"xfrmi","XfrmIfaceId":1,"N3IWFGTPBindAddress":"10.100.200.15","FQDN":"n3iwf.free5gc.org","PrivateKey":"cert/n3iwf.key","CertificateAuthority":"cert/n3iwf.pem","Certificate":"cert/n3iwf.pem","LivenessCheck":{"Enable":true,"TransFreq":60000000000,"MaxRetryTimes":4}},"Logger":{"Enable":true,"Level":"trace","ReportCaller":false}},"n3iwfctx":{"xfrmParentIface":"eth1","xfrmIfaceIdOffset":1,"ranUeCount":1,"ikeUeCount":1,"childSaCount":2,"amfKeys":["10.100.200.16:38412"],"allocatedUeIps":["10.0.0.2"],"ues":[{"RanUeNgapId":1,"AmfUeNgapId":1,"IPAddrv4":"192.168.10.114","IPAddrv6":"","PortNumber":500,"MaskedIMEISV":{"Value":{"Bytes":"ERAAAAD//wA=","BitLength":64}},"Guti":"","N3iwfCtx":null,"AMF":{"SCTPAddr":"10.100.200.16:38412","SCTPConn":{},"AMFName":{"Value":"AMF"},"ServedGUAMIList":{"List":[{"GUAMI":{"PLMNIdentity":{"Value":"Avg5"},"AMFRegionID":{"Value":{"Bytes":"yg==","BitLength":8}},"AMFSetID":{"Value":{"Bytes":"/gA=","BitLength":10}},"AMFPointer":{"Value":{"Bytes":"AA==","BitLength":6}},"IEExtensions":null},"BackupAMFName":null,"IEExtensions":null}]},"RelativeAMFCapacity":{"Value":255},"PLMNSupportList":{"List":[{"PLMNIdentity":{"Value":"Avg5"},"SliceSupportList":{"List":[{"SNSSAI":{"SST":{"Value":"AQ=="},"SD":{"Value":"AQID"},"IEExtensions":null},"IEExtensions":null},{"SNSSAI":{"SST":{"Value":"AQ=="},"SD":{"Value":"ESIz"},"IEExtensions":null},"IEExtensions":null}]},"IEExtensions":null}]},"AMFTNLAssociationList":{},"AMFOverloadContent":null,"N3iwfRanUeList":{}},"SecurityCapabilities":{"NRencryptionAlgorithms":{"Value":{"Bytes":"AAA=","BitLength":16}},"NRintegrityProtectionAlgorithms":{"Value":{"Bytes":"QAA=","BitLength":16}},"EUTRAencryptionAlgorithms":{"Value":{"Bytes":"AAA=","BitLength":16}},"EUTRAintegrityProtectionAlgorithms":{"Value":{"Bytes":"AAA=","BitLength":16}},"IEExtensions":null},"PduSessionList":{"1":{"Id":1,"Type":{"Value":0},"Ambr":{"PDUSessionAggregateMaximumBitRateDL":{"Value":1000000000},"PDUSessionAggregateMaximumBitRateUL":{"Value":1000000000},"IEExtensions":null},"Snssai":{"SST":{"Value":"AQ=="},"SD":{"Value":"AQID"},"IEExtensions":null},"NetworkInstance":null,"SecurityCipher":true,"SecurityIntegrity":true,"MaximumIntegrityDataRateUplink":null,"MaximumIntegrityDataRateDownlink":null,"GTPConnInfo":{"UPFIPAddr":"10.100.200.17","UPFUDPAddr":{"IP":"10.100.200.17","Port":2152,"Zone":""},"IncomingTEID":1,"OutgoingTEID":2},"ForwardingUPTNLInfo":null,"QosFlowsToForward":null,"QFIList":"AQI=","QosFlows":{"1":{"Identifier":1,"Parameters":{"QosCharacteristics":{"Present":1,"NonDynamic5QI":{"FiveQI":{"Value":9},"PriorityLevelQos":null,"AveragingWindow":null,"MaximumDataBurstVolume":null,"IEExtensions":null},"Dynamic5QI":null,"ChoiceExtensions":null},"AllocationAndRetentionPriority":{"PriorityLevelARP":{"Value":8},"PreEmptionCapability":{"Value":0},"PreEmptionVulnerability":{"Value":0},"IEExtensions":null},"GBRQosInformation":null,"ReflectiveQosAttribute":null,"AdditionalQosFlowInformation":null,"IEExtensions":null}},"2":{"Identifier":2,"Parameters":{"QosCharacteristics":{"Present":1,"NonDynamic5QI":{"FiveQI":{"Value":8},"PriorityLevelQos":null,"AveragingWindow":null,"MaximumDataBurstVolume":null,"IEExtensions":null},"Dynamic5QI":null,"ChoiceExtensions":null},"AllocationAndRetentionPriority":{"PriorityLevelARP":{"Value":8},"PreEmptionCapability":{"Value":0},"PreEmptionVulnerability":{"Value":0},"IEExtensions":null},"GBRQosInformation":null,"ReflectiveQosAttribute":null,"AdditionalQosFlowInformation":null,"IEExtensions":null}}}}},"TemporaryPDUSessionSetupData":{"UnactivatedPDUSession":[{"Id":1,"Type":{"Value":0},"Ambr":{"PDUSessionAggregateMaximumBitRateDL":{"Value":1000000000},"PDUSessionAggregateMaximumBitRateUL":{"Value":1000000000},"IEExtensions":null},"Snssai":{"SST":{"Value":"AQ=="},"SD":{"Value":"AQID"},"IEExtensions":null},"NetworkInstance":null,"SecurityCipher":true,"SecurityIntegrity":true,"MaximumIntegrityDataRateUplink":null,"MaximumIntegrityDataRateDownlink":null,"GTPConnInfo":{"UPFIPAddr":"10.100.200.17","UPFUDPAddr":{"IP":"10.100.200.17","Port":2152,"Zone":""},"IncomingTEID":1,"OutgoingTEID":2},"ForwardingUPTNLInfo":null,"QosFlowsToForward":null,"QFIList":"AQI=","QosFlows":{"1":{"Identifier":1,"Parameters":{"QosCharacteristics":{"Present":1,"NonDynamic5QI":{"FiveQI":{"Value":9},"PriorityLevelQos":null,"AveragingWindow":null,"MaximumDataBurstVolume":null,"IEExtensions":null},"Dynamic5QI":null,"ChoiceExtensions":null},"AllocationAndRetentionPriority":{"PriorityLevelARP":{"Value":8},"PreEmptionCapability":{"Value":0},"PreEmptionVulnerability":{"Value":0},"IEExtensions":null},"GBRQosInformation":null,"ReflectiveQosAttribute":null,"AdditionalQosFlowInformation":null,"IEExtensions":null}},"2":{"Identifier":2,"Parameters":{"QosCharacteristics":{"Present":1,"NonDynamic5QI":{"FiveQI":{"Value":8},"PriorityLevelQos":null,"AveragingWindow":null,"MaximumDataBurstVolume":null,"IEExtensions":null},"Dynamic5QI":null,"ChoiceExtensions":null},"AllocationAndRetentionPriority":{"PriorityLevelARP":{"Value":8},"PreEmptionCapability":{"Value":0},"PreEmptionVulnerability":{"Value":0},"IEExtensions":null},"GBRQosInformation":null,"ReflectiveQosAttribute":null,"AdditionalQosFlowInformation":null,"IEExtensions":null}}}}],"NGAPProcedureCode":{"Value":29},"SetupListCxtRes":null,"FailedListCxtRes":null,"SetupListSURes":{"List":[{"PDUSessionID":{"Value":1},"PDUSessionResourceSetupResponseTransfer":"AAPgCmTIDwAAAAEEAQCA","IEExtensions":null}]},"FailedListSURes":{"List":null},"FailedErrStr":["Nil","Nil"],"Index":1},"HandoverType":null,"HandoverCause":null,"Guami":{"PLMNIdentity":{"Value":"Avg5"},"AMFRegionID":{"Value":{"Bytes":"yg==","BitLength":8}},"AMFSetID":{"Value":{"Bytes":"/gA=","BitLength":10}},"AMFPointer":{"Value":{"Bytes":"AA==","BitLength":6}},"IEExtensions":null},"IndexToRfsp":0,"Ambr":null,"AllowedNssai":{"List":[{"SNSSAI":{"SST":{"Value":"AQ=="},"SD":{"Value":"AQID"},"IEExtensions":null},"IEExtensions":null}]},"MobilityRestrictionList":null,"SourceToTargetContainer":null,"TargetToSourceContainer":null,"RadioCapability":null,"CoreNetworkAssistanceInformation":null,"IMSVoiceSupported":0,"RRCEstablishmentCause":3,"PduSessionReleaseList":{"List":null},"UeCtxRelState":false,"PduSessResRelState":false,"NextHopNH":null,"NextHopChainingCount":0,"ReuseNasSecurity":false,"PathSwitchSent":false,"TemporaryCachedNASMessage":null,"IsNASTCPConnEstablished":true,"IsNASTCPConnEstablishedComplete":true,"TCPConnection":{}}],"n3iwfContext":{"amfPool":{"10.100.200.16:38412":{"SCTPAddr":"10.100.200.16:38412","SCTPConn":{},"AMFName":{"Value":"AMF"},"ServedGUAMIList":{"List":[{"GUAMI":{"PLMNIdentity":{"Value":"Avg5"},"AMFRegionID":{"Value":{"Bytes":"yg==","BitLength":8}},"AMFSetID":{"Value":{"Bytes":"/gA=","BitLength":10}},"AMFPointer":{"Value":{"Bytes":"AA==","BitLength":6}},"IEExtensions":null},"BackupAMFName":null,"IEExtensions":null}]},"RelativeAMFCapacity":{"Value":255},"PLMNSupportList":{"List":[{"PLMNIdentity":{"Value":"Avg5"},"SliceSupportList":{"List":[{"SNSSAI":{"SST":{"Value":"AQ=="},"SD":{"Value":"AQID"},"IEExtensions":null},"IEExtensions":null},{"SNSSAI":{"SST":{"Value":"AQ=="},"SD":{"Value":"ESIz"},"IEExtensions":null},"IEExtensions":null}]},"IEExtensions":null}]},"AMFTNLAssociationList":{},"AMFOverloadContent":null,"N3iwfRanUeList":{}}},"allocatedUeIps":[{"ueIpv4":"10.0.0.2"}],"ikeUePool":[{"IPSecInnerIP":"10.0.0.2","IPSecInnerIPAddr":{"IP":"10.0.0.2","Zone":""},"N3IWFIKESecurityAssociation":{"RemoteSPI":456456,"LocalSPI":9137299253402370629,"InitiatorMessageID":5,"ResponderMessageID":58,"State":4,"IKEConnection":{"Conn":{},"N3IWFAddr":{"IP":"192.168.10.254","Port":500,"Zone":""},"UEAddr":{"IP":"192.168.10.114","Port":500,"Zone":""}},"UeBehindNAT":false,"N3iwfBehindNAT":false,"DPDReqRetransTimer":{},"CurrentRetryTimes":0,"IsUseDPD":true},"N3IWFChildSecurityAssociation":{"1994915266":{"InboundSPI":1994915266,"OutboundSPI":3520651899,"XfrmIface":{"Index":2,"MTU":1500,"TxQLen":0,"Name":"xfrmi-default","HardwareAddr":null,"Flags":1,"RawFlags":65729,"ParentIndex":822,"MasterIndex":0,"Namespace":null,"Alias":"","Statistics":{"RxPackets":478,"TxPackets":481,"RxBytes":25728,"TxBytes":25978,"RxErrors":0,"TxErrors":10,"RxDropped":0,"TxDropped":10,"Multicast":0,"Collisions":0,"RxLengthErrors":0,"RxOverErrors":0,"RxCrcErrors":0,"RxFrameErrors":0,"RxFifoErrors":0,"RxMissedErrors":0,"TxAbortedErrors":0,"TxCarrierErrors":10,"TxFifoErrors":0,"TxHeartbeatErrors":0,"TxWindowErrors":0,"RxCompressed":0,"TxCompressed":0},"Promisc":0,"Xdp":{"Fd":0,"Attached":false,"Flags":0,"ProgId":0},"EncapType":"none","Protinfo":null,"OperState":0,"NetNsID":0,"NumTxQueues":1,"NumRxQueues":1,"GSOMaxSize":65536,"GSOMaxSegs":65535,"Vfs":null,"Group":0,"Slave":null,"Ifid":1},"XfrmStateList":[{"Dst":"192.168.10.254","Src":"192.168.10.114","Proto":50,"Mode":1,"Spi":1994915266,"Reqid":0,"ReplayWindow":0,"Limits":{"ByteSoft":18446744073709551615,"ByteHard":18446744073709551615,"PacketSoft":18446744073709551615,"PacketHard":18446744073709551615,"TimeSoft":0,"TimeHard":0,"TimeUseSoft":0,"TimeUseHard":0},"Statistics":{"ReplayWindow":0,"Replay":0,"Failed":0,"Bytes":1408,"Packets":17,"AddTime":1764411017,"UseTime":1764411020},"Mark":null,"OutputMark":0,"Ifid":1,"Auth":{"Name":"hmac(sha1)","Key":"cJhYRQP+fxVPKLuUDBd73VL4zHY=","TruncateLen":96,"ICVLen":0},"Crypt":{"Name":"cbc(aes)","Key":"9QvBeaMxd/75nbtWlMwvYpQGB3zkXA0JteYluCT+8Ng=","TruncateLen":0,"ICVLen":0},"Aead":null,"Encap":null,"ESN":false},{"Dst":"192.168.10.114","Src":"192.168.10.254","Proto":50,"Mode":1,"Spi":3520651899,"Reqid":0,"ReplayWindow":0,"Limits":{"ByteSoft":18446744073709551615,"ByteHard":18446744073709551615,"PacketSoft":18446744073709551615,"PacketHard":18446744073709551615,"TimeSoft":0,"TimeHard":0,"TimeUseSoft":0,"TimeUseHard":0},"Statistics":{"ReplayWindow":0,"Replay":0,"Failed":0,"Bytes":1408,"Packets":17,"AddTime":1764411017,"UseTime":1764411020},"Mark":null,"OutputMark":0,"Ifid":1,"Auth":{"Name":"hmac(sha1)","Key":"K+73jSLGcKLSnn2ic641WBeFEWc=","TruncateLen":96,"ICVLen":0},"Crypt":{"Name":"cbc(aes)","Key":"SN3Mt9sPpzedEiLbHx+a3r5rlXfHG8J9sqX5RTR08nI=","TruncateLen":0,"ICVLen":0},"Aead":null,"Encap":null,"ESN":false}],"XfrmPolicyList":[{"Dst":{"IP":"10.0.0.1","Mask":"/////w=="},"Src":{"IP":"10.0.0.2","Mask":"/////w=="},"Proto":47,"DstPort":0,"SrcPort":0,"Dir":0,"Priority":0,"Index":0,"Action":0,"Ifindex":0,"Ifid":1,"Mark":null,"Tmpls":[{"Dst":"192.168.10.254","Src":"192.168.10.114","Proto":50,"Mode":1,"Spi":1994915266,"Reqid":0}]},{"Dst":{"IP":"10.0.0.2","Mask":"/////w=="},"Src":{"IP":"10.0.0.1","Mask":"/////w=="},"Proto":47,"DstPort":0,"SrcPort":0,"Dir":1,"Priority":0,"Index":0,"Action":0,"Ifindex":0,"Ifid":1,"Mark":null,"Tmpls":[{"Dst":"192.168.10.114","Src":"192.168.10.254","Proto":50,"Mode":1,"Spi":3520651899,"Reqid":0}]}],"PeerPublicIPAddr":"192.168.10.114","LocalPublicIPAddr":"192.168.10.254","SelectedIPProtocol":47,"TrafficSelectorLocal":{"IP":"10.0.0.1","Mask":"/////w=="},"TrafficSelectorRemote":{"IP":"10.0.0.2","Mask":"/////w=="},"EnableEncapsulate":false,"N3IWFPort":0,"NATPort":0,"PDUSessionIds":[1],"LocalIsInitiator":true},"898669734":{"InboundSPI":898669734,"OutboundSPI":2,"XfrmIface":null,"XfrmStateList":[{"Dst":"192.168.10.254","Src":"192.168.10.114","Proto":50,"Mode":1,"Spi":898669734,"Reqid":0,"ReplayWindow":0,"Limits":{"ByteSoft":18446744073709551615,"ByteHard":18446744073709551615,"PacketSoft":18446744073709551615,"PacketHard":18446744073709551615,"TimeSoft":0,"TimeHard":0,"TimeUseSoft":0,"TimeUseHard":0},"Statistics":{"ReplayWindow":0,"Replay":0,"Failed":0,"Bytes":24320,"Packets":461,"AddTime":1764410992,"UseTime":1764410992},"Mark":null,"OutputMark":0,"Ifid":1,"Auth":{"Name":"hmac(sha1)","Key":"71YvGCNg44XkWHfLkNH5YhJGwLA=","TruncateLen":96,"ICVLen":0},"Crypt":{"Name":"cbc(aes)","Key":"HKthJLbZYBKe+CRRujZnR4nY8XdrSCtQyPd7JkCPqD4=","TruncateLen":0,"ICVLen":0},"Aead":null,"Encap":null,"ESN":false},{"Dst":"192.168.10.114","Src":"192.168.10.254","Proto":50,"Mode":1,"Spi":2,"Reqid":0,"ReplayWindow":0,"Limits":{"ByteSoft":18446744073709551615,"ByteHard":18446744073709551615,"PacketSoft":18446744073709551615,"PacketHard":18446744073709551615,"TimeSoft":0,"TimeHard":0,"TimeUseSoft":0,"TimeUseHard":0},"Statistics":{"ReplayWindow":0,"Replay":0,"Failed":0,"Bytes":24570,"Packets":464,"AddTime":1764410992,"UseTime":1764410992},"Mark":null,"OutputMark":0,"Ifid":1,"Auth":{"Name":"hmac(sha1)","Key":"gyc8e0rWVoDzJCPSjcIockGxY5A=","TruncateLen":96,"ICVLen":0},"Crypt":{"Name":"cbc(aes)","Key":"/e8YU0Jm5ebza34U/FIUJ440ZERLSUxbl0VK+I7poVw=","TruncateLen":0,"ICVLen":0},"Aead":null,"Encap":null,"ESN":false}],"XfrmPolicyList":[{"Dst":{"IP":"10.0.0.1","Mask":"/////w=="},"Src":{"IP":"10.0.0.2","Mask":"/////w=="},"Proto":6,"DstPort":0,"SrcPort":0,"Dir":0,"Priority":0,"Index":0,"Action":0,"Ifindex":0,"Ifid":1,"Mark":null,"Tmpls":[{"Dst":"192.168.10.254","Src":"192.168.10.114","Proto":50,"Mode":1,"Spi":898669734,"Reqid":0}]},{"Dst":{"IP":"10.0.0.2","Mask":"/////w=="},"Src":{"IP":"10.0.0.1","Mask":"/////w=="},"Proto":6,"DstPort":0,"SrcPort":0,"Dir":1,"Priority":0,"Index":0,"Action":0,"Ifindex":0,"Ifid":1,"Mark":null,"Tmpls":[{"Dst":"192.168.10.114","Src":"192.168.10.254","Proto":50,"Mode":1,"Spi":2,"Reqid":0}]}],"PeerPublicIPAddr":"192.168.10.114","LocalPublicIPAddr":"192.168.10.254","SelectedIPProtocol":6,"TrafficSelectorLocal":{"IP":"10.0.0.1","Mask":"/////w=="},"TrafficSelectorRemote":{"IP":"10.0.0.2","Mask":"/////w=="},"EnableEncapsulate":false,"N3IWFPort":0,"NATPort":0,"PDUSessionIds":[-1],"LocalIsInitiator":false}},"IKEConnection":{"Conn":{},"N3IWFAddr":{"IP":"192.168.10.254","Port":500,"Zone":""},"UEAddr":{"IP":"192.168.10.114","Port":500,"Zone":""}},"PduSessionListLen":1}],"ikeSpiToNgapId":{"9137299253402370629":1},"ngapIdToIkeSpi":{"1":9137299253402370629},"ipsecInnerIpPool":{"IPSubnet":{"IP":"10.0.0.0","Mask":"////AA=="},"Pool":{}},"xfrmIfaces":{"1":"xfrmi-default"}}}}}
